version: "3"

tasks:
  bundle:
    cmds:
      - eval "$(/opt/homebrew/bin/brew shellenv)" &&
        brew bundle --cleanup --formula --cask --tap --no-lock --zap

  dump:
    cmds:
      - brew bundle dump --force --formula --cask --tap --no-lock
      - 'sd -F ''{ appdir: "~/Applications" }'' ''{ appdir: "~/Applications", no_quarantine: true }'' Brewfile'

  install:
    cmds:
      - brew install --formula {{.CLI_ARGS}}
      - task: dump

  install-cask:
    aliases: [ic]
    cmds:
      - brew install --cask --no-quarantine --appdir=~/Applications {{.CLI_ARGS}}
      - task: dump
